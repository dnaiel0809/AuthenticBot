{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/* eslint-disable */\n\nimport http from \"@/http\";\nimport VueMarkdown from \"vue-markdown\";\nimport EasyMDE from \"easymde\";\nimport \"easymde/dist/easymde.min.css\";\nimport VueSimpleRangeSlider from \"vue-simple-range-slider/vue2\";\nimport \"vue-simple-range-slider/vue2/css\";\nimport Vue from \"vue\";\nimport { BootstrapVue, IconsPlugin } from \"bootstrap-vue\";\n\n// Import Bootstrap and BootstrapVue CSS files (order is important)\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"bootstrap-vue/dist/bootstrap-vue.css\";\nimport ElementUI from \"element-ui\";\nVue.use(ElementUI);\n// Make BootstrapVue available throughout your project\nVue.use(BootstrapVue);\nexport default {\n  name: \"EditWriting\",\n  components: {\n    EasyMDE\n  },\n  mounted() {\n    this.fetchData();\n    this.enableEditMode();\n    this.addSurveyListener();\n    // this.cannotGoback();\n    this.scrollToTop();\n  },\n  data() {\n    return {\n      text: \"\",\n      currentTask: 0,\n      Pid: \"\",\n      loading: true,\n      nextPageBool: false,\n      condition: \"\",\n      post: \"\"\n    };\n  },\n  methods: {\n    cannotGoback() {\n      window.onpopstate = function () {\n        history.go(1);\n      };\n    },\n    jumpyTo(url) {\n      if (this.$router.currentRoute.path !== url) {\n        this.$router.push({\n          path: url,\n          query: {\n            Pid: this.Pid,\n            condition: this.condition\n          }\n        });\n      }\n    },\n    scrollToTop() {\n      window.scrollTo(1, 2);\n    },\n    messagePop(type, message) {\n      this.$message({\n        message: `${message}`,\n        type: `${type}`\n      });\n    },\n    fetchData() {\n      console.log(\"Params: \", this.$route.query.currentTask);\n      console.log(\"Params: \", this.$route.query.Pid);\n      this.currentTask = this.$route.query.currentTask;\n      this.Pid = this.$route.query.Pid;\n      this.condition = this.$route.query.condition;\n      this.post = this.$route.query.post;\n      if (this.condition == \"3\") return;\n      this.addHashToLocation();\n      console.log(this.post);\n      http.post(\"/get_google_sheet_mimic_task/\", {\n        pid: this.Pid,\n        post: this.post\n      }).then(res => {\n        this.loading = false;\n        this.markdownEditor.value(res.data.mimic_output);\n        console.log(\"mimic_output\", res.data.mimic_output);\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    enableEditMode() {\n      this.editMode = true;\n      const vm = this;\n      this.$nextTick(() => {\n        if (!this.markdownEditor) {\n          this.markdownEditor = new EasyMDE({\n            element: this.$refs.markdownEditor\n          });\n\n          //设计样式\n          // const codemirrorScroll = document.getElementsByClassName('CodeMirror-scroll')[0];\n          const codemirrorScroll = document.getElementsByClassName(\"CodeMirror-scroll\")[0];\n          console.log(\"scoll\");\n          console.log(codemirrorScroll);\n          if (codemirrorScroll) {\n            codemirrorScroll.style.maxHeight = \"400px\";\n            codemirrorScroll.style.overflowY = \"auto\";\n            console.log(\"successfully set\");\n          }\n          this.markdownEditor.value(this.text);\n          this.markdownEditor.codemirror.on(\"change\", () => {\n            vm.text = vm.markdownEditor.value();\n            console.log(vm.text); // 输出当前的输入值\n          });\n        }\n      });\n    },\n\n    submitWriting() {\n      http.post(\"/upload_google_sheet_edited_task/\", {\n        pid: this.Pid,\n        post: this.post,\n        editedText: this.text\n      }).then(res => {\n        console.log(\"success\", res.data.success);\n        this.messagePop(\"success\", \"Successfully submit!\");\n        // this.jumpyTo(\"/writing_assitant_show\");\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    nextpage() {\n      if (this.condition != \"3\") {\n        this.submitWriting();\n      }\n      if (this.currentTask == 1) {\n        this.jumpyTo(\"/post_survey\");\n      } else {\n        this.jumpyTo(\"/writing_assitant_show\");\n      }\n    },\n    addSurveyListener() {\n      window.addEventListener(\"message\", e => {\n        console.log(e);\n        if (e.origin.includes(\"https://nus.syd1.qualtrics.com\") && e.data.includes(\"QualtricsEOS|SV_6hzftT2MX5eWOua\")) {\n          this.nextPageBool = true;\n          console.log(\"survey end\");\n          this.nextpage();\n        }\n      });\n    },\n    addHashToLocation() {\n      let params = \"?PID=\" + this.Pid + \"&condition=\" + this.condition + \"&post=\" + this.post;\n      // history.pushState({}, null, this.$route.path + \"#\" + params);\n      const iframe = this.$refs.Iframe;\n      iframe.src = \"https://nus.syd1.qualtrics.com/jfe/form/SV_6hzftT2MX5eWOua\" + params;\n    }\n  },\n  updated() {\n    if (this.condition == \"3\") {\n      this.nextpage();\n    }\n  }\n};","map":{"version":3,"names":["http","VueMarkdown","EasyMDE","VueSimpleRangeSlider","Vue","BootstrapVue","IconsPlugin","ElementUI","use","name","components","mounted","fetchData","enableEditMode","addSurveyListener","scrollToTop","data","text","currentTask","Pid","loading","nextPageBool","condition","post","methods","cannotGoback","window","onpopstate","history","go","jumpyTo","url","$router","currentRoute","path","push","query","scrollTo","messagePop","type","message","$message","console","log","$route","addHashToLocation","pid","then","res","markdownEditor","value","mimic_output","catch","e","editMode","vm","$nextTick","element","$refs","codemirrorScroll","document","getElementsByClassName","style","maxHeight","overflowY","codemirror","on","submitWriting","editedText","success","nextpage","addEventListener","origin","includes","params","iframe","Iframe","src","updated"],"sources":["src/components/EditWriting.vue"],"sourcesContent":["@import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');\n\n\n<template>\n  <div>\n    <header class=\"header-slot\">\n      <slot name=\"header\"><h4>Support message web</h4></slot>\n    </header>\n    <div class=\"container\">\n      <p><br /></p>\n      <p style=\"font-size: 1rem\">\n        You can now revise the message as needed. Feel free to make any changes\n        if you see fit. When you're satisfied with your message, please submit\n        it. Note that this support message will be shared anonymously in an\n        online peer support community.\n      </p>\n      <p>After you submit, you'll be asked to evaluate your written message.</p>\n      <div\n        class=\"grid-content bg-light\"\n        v-loading=\"loading\"\n        element-loading-text=\"loading...\"\n      >\n        <div class=\"label_container\" style=\"display: flex\">\n          <label\n            style=\"\n              font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n              font-size: large;\n            \"\n          ></label>\n        </div>\n        <textarea\n          id=\"outputArea\"\n          ref=\"enableEditMode\"\n          class=\"textarea\"\n        ></textarea>\n        <!-- <b-row align=\"center\">\n          <el-button @click=\"getRegenerateMimic\" type=\"primary\"\n            >Regenerate</el-button\n          >\n        </b-row> -->\n        <!-- <center>\n          <el-button @click=\"submitWriting\" type=\"primary\" style=\"\"\n            >Submit</el-button\n          >\n        </center> -->\n      </div>\n      <div>\n        <iframe ref=\"Iframe\" width=\"100%\" height=\"1300px\"></iframe>\n        <center>\n          <el-button\n            @click=\"nextpage\"\n            type=\"primary\"\n            style=\"margin: 10px\"\n            v-show=\"nextPageBool\"\n            >next page</el-button\n          >\n        </center>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/* eslint-disable */\n\nimport http from \"@/http\";\nimport VueMarkdown from \"vue-markdown\";\nimport EasyMDE from \"easymde\";\nimport \"easymde/dist/easymde.min.css\";\nimport VueSimpleRangeSlider from \"vue-simple-range-slider/vue2\";\nimport \"vue-simple-range-slider/vue2/css\";\nimport Vue from \"vue\";\nimport { BootstrapVue, IconsPlugin } from \"bootstrap-vue\";\n\n// Import Bootstrap and BootstrapVue CSS files (order is important)\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"bootstrap-vue/dist/bootstrap-vue.css\";\nimport ElementUI from \"element-ui\";\n\nVue.use(ElementUI);\n// Make BootstrapVue available throughout your project\nVue.use(BootstrapVue);\n\nexport default {\n  name: \"EditWriting\",\n  components: { EasyMDE },\n\n  mounted() {\n    this.fetchData();\n    this.enableEditMode();\n    this.addSurveyListener();\n    // this.cannotGoback();\n    this.scrollToTop();\n  },\n  data() {\n    return {\n      text: \"\",\n      currentTask: 0,\n      Pid: \"\",\n      loading: true,\n      nextPageBool: false,\n      condition: \"\",\n      post: \"\",\n    };\n  },\n\n  methods: {\n    cannotGoback() {\n      window.onpopstate = function () {\n        history.go(1);\n      };\n    },\n    jumpyTo(url) {\n      if (this.$router.currentRoute.path !== url) {\n        this.$router.push({\n          path: url,\n          query: { Pid: this.Pid, condition: this.condition },\n        });\n      }\n    },\n    scrollToTop() {\n      window.scrollTo(1, 2);\n    },\n    messagePop(type, message) {\n      this.$message({\n        message: `${message}`,\n        type: `${type}`,\n      });\n    },\n    fetchData() {\n      console.log(\"Params: \", this.$route.query.currentTask);\n      console.log(\"Params: \", this.$route.query.Pid);\n      this.currentTask = this.$route.query.currentTask;\n      this.Pid = this.$route.query.Pid;\n      this.condition = this.$route.query.condition;\n      this.post = this.$route.query.post;\n      if (this.condition == \"3\") return;\n      this.addHashToLocation();\n      console.log(this.post);\n      http\n        .post(\"/get_google_sheet_mimic_task/\", {\n          pid: this.Pid,\n          post: this.post,\n        })\n        .then((res) => {\n          this.loading = false;\n          this.markdownEditor.value(res.data.mimic_output);\n          console.log(\"mimic_output\", res.data.mimic_output);\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    },\n    enableEditMode() {\n      this.editMode = true;\n      const vm = this;\n      this.$nextTick(() => {\n        if (!this.markdownEditor) {\n          this.markdownEditor = new EasyMDE({\n            element: this.$refs.markdownEditor,\n          });\n\n          //设计样式\n          // const codemirrorScroll = document.getElementsByClassName('CodeMirror-scroll')[0];\n          const codemirrorScroll =\n            document.getElementsByClassName(\"CodeMirror-scroll\")[0];\n          console.log(\"scoll\");\n          console.log(codemirrorScroll);\n          if (codemirrorScroll) {\n            codemirrorScroll.style.maxHeight = \"400px\";\n            codemirrorScroll.style.overflowY = \"auto\";\n            console.log(\"successfully set\");\n          }\n          this.markdownEditor.value(this.text);\n          this.markdownEditor.codemirror.on(\"change\", () => {\n            vm.text = vm.markdownEditor.value();\n            console.log(vm.text); // 输出当前的输入值\n          });\n        }\n      });\n    },\n    submitWriting() {\n      http\n        .post(\"/upload_google_sheet_edited_task/\", {\n          pid: this.Pid,\n          post: this.post,\n          editedText: this.text,\n        })\n        .then((res) => {\n          console.log(\"success\", res.data.success);\n          this.messagePop(\"success\", \"Successfully submit!\");\n          // this.jumpyTo(\"/writing_assitant_show\");\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    },\n    nextpage() {\n      if (this.condition != \"3\") {\n        this.submitWriting();\n      }\n      if (this.currentTask == 1) {\n        this.jumpyTo(\"/post_survey\");\n      } else {\n        this.jumpyTo(\"/writing_assitant_show\");\n      }\n    },\n    addSurveyListener() {\n      window.addEventListener(\"message\", (e) => {\n        console.log(e);\n        if (\n          e.origin.includes(\"https://nus.syd1.qualtrics.com\") &&\n          e.data.includes(\"QualtricsEOS|SV_6hzftT2MX5eWOua\")\n        ) {\n          this.nextPageBool = true;\n          console.log(\"survey end\");\n          this.nextpage();\n        }\n      });\n    },\n    addHashToLocation() {\n      let params =\n        \"?PID=\" +\n        this.Pid +\n        \"&condition=\" +\n        this.condition +\n        \"&post=\" +\n        this.post;\n      // history.pushState({}, null, this.$route.path + \"#\" + params);\n      const iframe = this.$refs.Iframe;\n      iframe.src =\n        \"https://nus.syd1.qualtrics.com/jfe/form/SV_6hzftT2MX5eWOua\" + params;\n    },\n  },\n  updated() {\n    if (this.condition == \"3\") {\n      this.nextpage();\n    }\n  },\n};\n</script>\n\n<style scoped>\n.container {\n  background: white;\n  width: 75%;\n  height: auto;\n  margin: auto;\n}\n.header {\n  margin-left: 4em;\n  /*margin-top: 4em;*/\n  padding-top: 4em;\n  display: flex;\n}\n\n.button {\n  /*width: 100px;*/\n  width: 10%;\n}\n\n.drop-item {\n  /*width: 500px;*/\n  font-family: ColfaxAI, helvetica, sans-serif;\n  font-size: small;\n  /*white-space: normal;*/\n  /*word-wrap: break-word;*/\n}\n\n.translate-container {\n  padding: 20px;\n}\n\n.grid-content {\n  height: 600px;\n  border-radius: 4px;\n  margin-bottom: 20px;\n  padding-left: 4em;\n}\n\n.grid-content-post {\n  height: 350px;\n  border-radius: 4px;\n  margin-bottom: 20px;\n  padding-left: 4em;\n}\n\n.grid-content-post2 {\n  height: 500px;\n  border-radius: 4px;\n  margin-bottom: 20px;\n  padding-left: 4em;\n}\n\n.slider-content {\n  height: 450px;\n  border-radius: 4px;\n  margin-bottom: 20px;\n  padding-left: 4em;\n  padding-right: 4em;\n}\n\n.bg-light {\n  padding: 20px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n\n.textarea {\n  padding-top: 1em;\n  padding-left: 1em;\n  padding-right: 1em;\n  padding-bottom: 1em;\n  height: 550px;\n\n  /*font-family: 'Arial', sans-serif; !* 这将更改字体 *!*/\n  font-family: \"Roboto\", sans-serif;\n  font-size: 16px; /* 这将更改字体大小 */\n  color: #333; /* 这将更改文本颜色 */\n  line-height: 1.5; /* 这将更改行高 */\n  letter-spacing: 0.05em; /* 这将更改字符间距 */\n  text-align: justify; /* 这将使文本两端对齐 */\n  overflow-y: scroll;\n}\n\n.el-icon-arrow-down {\n  font-size: 12px;\n}\n\n.el-menu-item i {\n  float: right;\n  margin-top: 5px;\n  cursor: pointer;\n}\n\n.example {\n  background: #ffffff;\n  margin: 20px;\n  border-color: #e7e7e7;\n  padding: 40px;\n}\n.header-slot {\n  background: #d4e6ff;\n  padding: 20px 100px;\n  position: sticky;\n  top: 0;\n  /* z-index: 10000; */\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}